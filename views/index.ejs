<html>
    <head>
        <meta name="8thwall:renderer" content="aframe:1.6.0" />
<meta name="8thwall:package" content="@8thwall.xrextras" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>

<!-- XR Extras -->
<script src="https://cdn.8thwall.com/web/xrextras/xrextras.js"></script>
  <script src="https://unpkg.com/aframe-chromakey-material/dist/aframe-chromakey-material.min.js"></script>

<!-- OPTIONAL chromakey (only if patched / old aframe) -->
<!-- <script src="https://cdn.8thwall.com/web/aframe/aframe-chromakey-material-1.1.1.min.js"></script>  -->


<script async src="https://apps.8thwall.com/xrweb?appKey=ym1JxzIYnxbmxwN90RLaimxesODoLzjyOYL4s1TUlm5I2NXNN6vn2wLeMBK15Wssxz0IVv"></script>
<script crossorigin="anonymous"
    src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
<style>body { 
  font-family: 'Contrail One', monospace;
  background: black;
}

.absolute-fill {
  z-index: 10;
  position:absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  pointer-events: none;
}

#recenterButton {
  position: absolute;
  z-index: 5;
  left: 2vh;
  bottom: 2vh;
  max-width: 50px;
  pointer-events: auto;
}

#promptText {
  font-size: 8vw;
  text-align: center;

  color: white;
  text-shadow: 2px 2px 8px purple;
  
  position: absolute;
  width: 100%;
  bottom: 12vh;
  left: 50%;
  transform: translate(-50%, 0);
}

/* ANIMATIONS */

.fly-in {animation: fly-in 1.5s ease-out both;}
@keyframes fly-in {
  0%   {transform: translate(-100%, 0%);  opacity: 0;}
  70%  {opacity: 1;}
  100%  {transform: translate(-50%, 0%); opacity: 1;}
}

.fly-out {animation: fly-out 1.5s ease-out both;}
@keyframes fly-out {
  0%  {transform: translate(-50%, 0%); opacity: 1;}
  70%  {opacity: 0;}
  100%   {transform: translate(0%, 0%); opacity: 0;}
}

.pulse-once { animation: pulse-once 0.2s cubic-bezier(0.785, 0.135, 0.150, 0.860) both; }
@keyframes pulse-once {
  0% {transform: scale(1);}
  50% {transform: scale(0.8);}
  100% {transform: scale(1);}
}
</style>

</script>
    </head>
    <body>
   

<div id="overlay" style="display: none" class="absolute-fill">
  <img id="recenterButton" src="./assets/textures/recenter.png" />
  <span id="promptText"></span>
</div>

<a-scene
  responsive-immersive
  landing-page="mediaSrc: #landing-page-video;"
  xrextras-loading
  xrextras-runtime-error
  renderer="colorManagement: true;"
  xrweb="allowedDevices: any; disableDefaultEnvironment: true;">
  <!-- <xrextras-resource id="landing-page-video" src="./assets/moon-portal.mp4"></xrextras-resource> -->

  <!-- We can define assets here to be loaded while the load screen is displayed -->
  <a-assets>
    <!-- models -->
    <a-asset-item id="portal-rim-model" src="/assets/models/portal.glb"></a-asset-item>

    <!-- textures -->
    <img id="skybox-img" src="/assets/textures/skybox.jpg" />
    <img id="blob-shadow-img" src="/assets/textures/blob-shadow.png" />

    <video
      id="portal-video"
      muted
      autoplay
      playsinline
      crossorigin="anonymous"
      loop="true"
      src="/assets/textures/portal-video.mp4"></video>
  </a-assets>

  <!-- Camera -->
  <a-camera id="camera" position="0 9 11"> </a-camera>
  <a-entity
    id="portalRim"
    gltf-model="#portal-rim-model"
    position="0 3.7 -2"
    rotation="0 -90 0"
    scale="0.0001 0.0001 0.0001"
    shadow="receive: false">
  </a-entity>
  <!-- Hider walls -->
  <xrextras-opaque-background remove="true">
    <a-entity id="hider-walls">
      <a-box scale="100 1 100" position="0 -1 49" xrextras-hider-material></a-box>
      <a-box scale="100 100 1" position="0 50 75" xrextras-hider-material></a-box>
      <a-box scale="100 1 100" position="0 100 49" xrextras-hider-material></a-box>
      <a-box scale="1 100 100" position="-30 50 50" xrextras-hider-material></a-box>
      <a-box scale="1 100 100" position="30 50 50" xrextras-hider-material></a-box>
      <a-plane scale="3 7 0" position="3.3 7.5 -0.2" xrextras-hider-material></a-plane>
      <a-plane scale="3 7 0" position="-3.3 7.5 -0.2" xrextras-hider-material></a-plane>
      <a-ring
        id="portalHiderRing"
        radius-inner="0.001"
        radius-outer="100"
        position="0 7.5 -0.2"
        xrextras-hider-material></a-ring>
    </a-entity>

    <a-entity id="portal-wall">
      <a-box
        rotation="0 180 0"
        position="0 7.5 0"
        scale="0.8 0.8 0"
        xrextras-hider-material></a-box>
      <a-box
        rotation="0 180 0"
        position="0 7.5 0.25"
        scale="0.8 0.8 0"
        xrextras-hider-material></a-box>
    </a-entity>
  </xrextras-opaque-background>

  <!-- Lights -->
  <a-entity
    light="
      type: directional;
      castShadow: true;
      shadowMapHeight:2048;
      shadowMapWidth:2048;
      shadowCameraTop: 35;
      shadowCameraBottom: -20;
      shadowCameraRight: 40;
      shadowCameraLeft: -10;
      target: #portalRim"
    xrextras-attach="target: portalRim; offset: 18 7 14"
    shadow>
  </a-entity>

  <a-light type="ambient" intensity="0.3"></a-light>

  <!-- Portal Contents -->
  <a-entity id="portal-contents">
    <a-sky src="#skybox-img" rotation="0 7 0"></a-sky>
  </a-entity>

  <!-- Portal -->

 

  <a-circle
    id="portalShadow"
    radius="0.5"
    material="src: #blob-shadow-img; opacity: 0.65; roughness: 0.8; metalness: 0"
    position="0 0.01 1.25"
    rotation="-90 0 0"
    scale="0.001 0.001 0.001">
  </a-circle>
</a-scene>
<script type="models" src="/main-bundled.js"></script>

    </body>
</html>